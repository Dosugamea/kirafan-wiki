{"version":3,"sources":["webpack:///./src/views/Scenario/index.vue?4f4b","webpack:///./src/views/Scenario/Item.vue?e0c3","webpack:///src/views/Scenario/Item.vue","webpack:///./src/views/Scenario/Item.vue?8387","webpack:///./src/views/Scenario/Item.vue","webpack:///src/views/Scenario/index.vue","webpack:///./src/views/Scenario/index.vue?0064","webpack:///./src/views/Scenario/index.vue?f100","webpack:///./src/views/Scenario/index.vue?609c"],"names":["render","_vm","this","_h","$createElement","_c","_self","adv","staticClass","_v","_s","m_Title","m_LibraryID","m_ScriptTextName","$t","format","parseInt","slice","_e","$name","$store","state","$db","ADVLibraryList","m_ListName","attrs","scenarios","index","on","$event","$router","replace","concat","m_AdvID","cue","voice_loaded","loading","_l","text","item","key","m_id","get_voice_injected_item","id","staticRenderFns","character","$size","push","m_ResourceBaseName","m_Datas","m_FaceReferenceImageType","m_FacePattern","$asset","standpic","base","style","show_voice","voice_url","name","staticStyle","domProps","$vuetify","breakpoint","xsOnly","props","data","computed","m_charaName","split","voice","VoiceList","m_VoiceID","ADVCharacterList","indexOf","position","scale","toLowerCase","m_text","methods","face","mounted","component","VImg","VListItem","VListItemAvatar","VListItemContent","VList","VListItemSubtitle","components","Item","cue_list","voice_promise","ADVList","$s","loadScenarioVoice","m_CueSheet","undefined","categories","1","path","2","3","4","5","6","7","i","trim","Boolean","Object","keys","length","get_audiobuffer_then_write","file_name","file_save_name","proxy_url","fetch","then","fs","get_event_seq","file_base_name","get_acb_awb","cri_audio_acb","cri_audio_awb","Promise","unpack_to_cue_list","define","cri","namels_n_prom","prom","audio","Name","blob","type","URL","url","promise","load","axios","get","watch","VBtn","VCol","VDivider","VIcon","VProgressCircular","VRow"],"mappings":"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","file":"js/chunk-0c3a169a.97ee94a8.js","sourcesContent":["var render = function () {\n  var _vm=this;\n  var _h=_vm.$createElement;\n  var _c=_vm._self._c||_h;\n\n  return !_vm.adv ? _c('div', {\n    staticClass: \"pa-4\"\n  }, [_c('KeyValue', {\n    attrs: {\n      \"k\": _vm.$t('No Scenario')\n    }\n  })], 1) : _c('div', [_c('p', {\n    staticClass: \"display px-4 primary--text\"\n  }, [_vm._v(_vm._s(_vm.adv.m_Title))]), _vm.adv.m_LibraryID != -1 ? [_c('p', {\n    staticClass: \"px-4 primary--text\"\n  }, [_vm.adv.m_ScriptTextName ? [_c('span', [_vm._v(_vm._s(_vm.$t('Section').format(parseInt(_vm.adv.m_ScriptTextName.slice(-2)))))]), _c('span', [_vm._v(\" — \")])] : _vm._e(), _c('span', [_vm._v(_vm._s(_vm.$name(_vm.$store.state.$db.ADVLibraryList[_vm.adv.m_LibraryID].m_ListName)))])], 2), _c('div', {\n    staticClass: \"px-4 mb-4\"\n  }, [_c('div', {\n    staticClass: \"float-right\"\n  }, [_c('v-btn', {\n    attrs: {\n      \"icon\": \"\",\n      \"disabled\": !_vm.scenarios[_vm.index + 1]\n    },\n    on: {\n      \"click\": function click($event) {\n        return _vm.$router.replace(\"/scenario/\".concat(_vm.scenarios[_vm.index + 1].m_AdvID));\n      }\n    }\n  }, [_c('v-icon', [_vm._v(\"mdi-chevron-right\")])], 1)], 1), _c('div', [_c('v-btn', {\n    attrs: {\n      \"icon\": \"\",\n      \"disabled\": !_vm.scenarios[_vm.index - 1]\n    },\n    on: {\n      \"click\": function click($event) {\n        return _vm.$router.replace(\"/scenario/\".concat(_vm.scenarios[_vm.index - 1].m_AdvID));\n      }\n    }\n  }, [_c('v-icon', [_vm._v(\"mdi-chevron-left\")])], 1)], 1)])] : _vm._e(), _c('v-divider'), this.cue && !_vm.voice_loaded ? _c('div', {\n    staticClass: \"py-4 text-center\"\n  }, [_c('v-row', [_c('v-col', {\n    staticClass: \"text-end\",\n    attrs: {\n      \"cols\": \"5\"\n    }\n  }, [_c('v-progress-circular', {\n    attrs: {\n      \"indeterminate\": \"\",\n      \"color\": \"primary\"\n    }\n  })], 1), _c('v-col', {\n    staticClass: \"text-start\",\n    attrs: {\n      \"cols\": \"7\"\n    }\n  }, [_c('div', {\n    staticClass: \"pt-2\"\n  }, [_vm._v(_vm._s(_vm.$t('Voice Loading')))])])], 1)], 1) : _vm._e(), !_vm.adv.m_ScriptTextName ? _c('div', {\n    staticClass: \"pa-4\"\n  }, [_c('KeyValue', {\n    attrs: {\n      \"k\": _vm.$t('No Scenario')\n    }\n  })], 1) : _vm.loading ? _c('div', {\n    staticClass: \"py-4 text-center\"\n  }, [_c('v-progress-circular', {\n    attrs: {\n      \"indeterminate\": \"\",\n      \"color\": \"primary\"\n    }\n  })], 1) : [_vm._l(_vm.text, function (item) {\n    return _c('div', {\n      key: \"scenario-text-\".concat(item.m_id)\n    }, [_c('Item', {\n      attrs: {\n        \"item\": _vm.get_voice_injected_item(item),\n        \"show_voice\": function show_voice() {\n          return _vm.voice_loaded;\n        }\n      }\n    })], 1);\n  }), _c('v-divider'), _c('Ad', {\n    key: \"scenario-ad-\".concat(_vm.id)\n  }), _vm.adv.m_LibraryID != -1 ? [_c('v-divider', {\n    staticClass: \"mb-4\"\n  }), _c('div', {\n    staticClass: \"px-4\"\n  }, [_c('div', {\n    staticClass: \"float-right\"\n  }, [_c('v-btn', {\n    attrs: {\n      \"icon\": \"\",\n      \"disabled\": !_vm.scenarios[_vm.index + 1]\n    },\n    on: {\n      \"click\": function click($event) {\n        return _vm.$router.replace(\"/scenario/\".concat(_vm.scenarios[_vm.index + 1].m_AdvID));\n      }\n    }\n  }, [_c('v-icon', [_vm._v(\"mdi-chevron-right\")])], 1)], 1), _c('div', [_c('v-btn', {\n    attrs: {\n      \"icon\": \"\",\n      \"disabled\": !_vm.scenarios[_vm.index - 1]\n    },\n    on: {\n      \"click\": function click($event) {\n        return _vm.$router.replace(\"/scenario/\".concat(_vm.scenarios[_vm.index - 1].m_AdvID));\n      }\n    }\n  }, [_c('v-icon', [_vm._v(\"mdi-chevron-left\")])], 1)], 1)])] : _vm._e()]], 2);\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {\n  var _vm=this;\n  var _h=_vm.$createElement;\n  var _c=_vm._self._c||_h;\n\n  return _c('v-list-item', [_vm.character ? _c('v-list-item-avatar', {\n    staticClass: \"mx-auto mr-2 mr-md-4\",\n    attrs: {\n      \"size\": _vm.$size(),\n      \"tile\": \"\"\n    },\n    on: {\n      \"click\": function click($event) {\n        return _vm.$router.push(\"/standpic/\".concat(_vm.character.m_ResourceBaseName));\n      }\n    }\n  }, [_vm.character.m_Datas[0].m_FaceReferenceImageType == 0 && _vm.character.m_Datas[0].m_FacePattern != -1 ? _c('v-img', {\n    attrs: {\n      \"src\": _vm.$asset.standpic.format(_vm.base, \"\".concat(_vm.base, \"_face_0_default\")) + '.png'\n    }\n  }) : _vm.character.m_Datas[0].m_FaceReferenceImageType == 0 && _vm.character.m_Datas[0].m_FacePattern == -1 ? _c('div', {\n    style: _vm.style('standpic_0')\n  }) : _vm.character.m_Datas[0].m_FaceReferenceImageType == 1 ? _c('div', {\n    style: _vm.style('face_0_default')\n  }) : _vm._e()], 1) : _c('v-list-item-avatar', {\n    staticClass: \"mx-auto mr-2 mr-md-4\",\n    attrs: {\n      \"size\": _vm.$size(),\n      \"tile\": \"\"\n    }\n  }), _vm.show_voice() ? _c('div', {\n    staticClass: \"mr-3\"\n  }, [_vm.voice_url ? _c('voice', {\n    style: \"width:\".concat(_vm.$size(), \"px;height:\").concat(_vm.$size(), \"px;\"),\n    attrs: {\n      \"name\": _vm.name,\n      \"cue\": _vm.text.replace('br', '').replace(/s+/g, ''),\n      \"override_url\": _vm.voice_url\n    }\n  }) : _c('Voice', {\n    style: \"visibility: hidden;width:\".concat(_vm.$size(), \"px;height:\").concat(_vm.$size(), \"px;\")\n  })], 1) : _vm._e(), _c('v-list-item-content', {\n    staticClass: \"mr-auto ml-0 py-1\",\n    staticStyle: {\n      \"max-width\": \"384px\"\n    }\n  }, [_c('v-list-item-subtitle', {\n    staticClass: \"primary--text\",\n    domProps: {\n      \"innerHTML\": _vm._s(_vm.name)\n    }\n  }), _c('div', {\n    style: {\n      'line-height': 1.5,\n      'font-size': _vm.$vuetify.breakpoint.xsOnly ? '70%' : null\n    },\n    domProps: {\n      \"innerHTML\": _vm._s(_vm.text)\n    }\n  })], 1)], 1);\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\n  v-list-item\n    v-list-item-avatar.mx-auto.mr-2.mr-md-4(:size=\"$size()\", tile, \n      v-if=\"character\", @click=\"$router.push(`/standpic/${character.m_ResourceBaseName}`)\")\n\n      v-img(v-if=\"character.m_Datas[0].m_FaceReferenceImageType==0 && character.m_Datas[0].m_FacePattern!=-1\",\n        :src=\"$asset.standpic.format(base, `${base}_face_0_default`) + '.png'\")\n      div(v-else-if=\"character.m_Datas[0].m_FaceReferenceImageType==0 && character.m_Datas[0].m_FacePattern==-1\",\n        :style=\"style('standpic_0')\")\n      div(v-else-if=\"character.m_Datas[0].m_FaceReferenceImageType==1\",\n        :style=\"style('face_0_default')\")\n\n    v-list-item-avatar.mx-auto.mr-2.mr-md-4(:size=\"$size()\", tile, v-else)\n    .mr-3(v-if=\"show_voice()\")\n      voice(\n        v-if=\"voice_url\"\n        :name=\"name\",\n        :cue=\"text.replace('br', '').replace(/\\s+/g, '')\",\n        :override_url=\"voice_url\"\n        :style=\"`width:${$size()}px;height:${$size()}px;`\"\n      )\n      //- XXX:サイズがわからないので、実体を非表示としておいておく\n      Voice(\n        v-else\n        :style=\"`visibility: hidden;width:${$size()}px;height:${$size()}px;`\"\n      )\n\n    v-list-item-content.mr-auto.ml-0.py-1(style=\"max-width: 384px\")\n      v-list-item-subtitle.primary--text(v-html=\"name\")\n      div(v-html=\"text\", :style=\"{'line-height': 1.5, 'font-size': $vuetify.breakpoint.xsOnly ? '70%': null}\")\n        //- p {{item}}\n        //- p {{character}}\n</template>\n\n<script>\nexport default {\n  name: 'Item',\n  props:[\"item\", \"show_voice\"],\n  data() {\n    return {\n      voice_url: undefined,\n    };\n  },\n  computed: {\n    id() {\n      return this.item.m_charaName.split('$')[1] || this.item.m_charaName;\n    },\n    voice () {\n      return this.$store.state.$db.VoiceList[this.item.m_VoiceID];\n    },\n    character() {\n      return this.$store.state.$db.ADVCharacterList[this.id];\n    },\n    name() {\n      return this.item.m_charaName.indexOf('$') == -1 ?\n        (this.character ? this.character.m_DisplayName : this.item.m_charaName) :\n        this.item.m_charaName.split('$')[0];\n    },\n    position() {\n      let x = this.character.m_Datas[0].m_FaceX;\n      let y = this.character.m_Datas[0].m_FaceY;\n      let base = this.$size() * this.scale / 2;\n      return `${base - x}px ${base - y}px`;\n    },\n    scale() {\n      return 200 / this.$size();\n    },\n    base() {\n      return this.character.m_ResourceBaseName.toLowerCase();\n    },\n    text() {\n      return this.item.m_text\n        .replace(/\\n/g, '<br>')\n        .replace(/<color=(.*?)>(.*?)<\\/color>/g, function (_, color, text) {\n          return `<span style=\"color: ${color}\">${text}</span>`;\n        });\n    },\n  },\n  methods: {\n    style(face) {\n      return {\n        'min-height': `${this.$size() * this.scale}px`,\n        'min-width': `${this.$size() * this.scale}px`,\n        'transform': `scale(${1 / this.scale})`,\n        'background-image': `url(${this.$asset.standpic.format(\n          this.base,\n          `${this.base}_${face}`\n        )}.png)`,\n        'background-position': this.position,\n        // 'background-size': '100%',\n      };\n    },\n  },\n  async mounted(){\n    if(this.item.voice_url){\n      this.voice_url = await this.item.voice_url;\n    }\n  }\n};\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Item.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Item.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Item.vue?vue&type=template&id=41b8f061&lang=pug&\"\nimport script from \"./Item.vue?vue&type=script&lang=js&\"\nexport * from \"./Item.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemAvatar } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemSubtitle } from 'vuetify/lib/components/VList';\ninstallComponents(component, {VImg,VListItem,VListItemAvatar,VListItemContent,VListItemSubtitle})\n","<template lang=\"pug\">\n  .pa-4(v-if=\"!adv\")\n    KeyValue(:k=\"$t('No Scenario')\")\n\n  div(v-else)\n    p.display.px-4.primary--text {{adv.m_Title}}\n    template(v-if=\"adv.m_LibraryID!=-1\")\n      p.px-4.primary--text\n        template(v-if=\"adv.m_ScriptTextName\")\n          span {{$t('Section').format(parseInt(adv.m_ScriptTextName.slice(-2)))}}\n          span  — \n        span {{$name($store.state.$db.ADVLibraryList[adv.m_LibraryID].m_ListName)}}\n      .px-4.mb-4\n        .float-right\n          v-btn(icon, :disabled=\"!scenarios[index+1]\",\n            @click=\"$router.replace(`/scenario/${scenarios[index+1].m_AdvID}`)\")\n            v-icon mdi-chevron-right\n        div\n          v-btn(icon, :disabled=\"!scenarios[index-1]\",\n            @click=\"$router.replace(`/scenario/${scenarios[index-1].m_AdvID}`)\")\n            v-icon mdi-chevron-left\n\n    v-divider\n\n    .py-4.text-center(v-if=\"this.cue && !voice_loaded\")\n      v-row\n        v-col(cols=\"5\").text-end\n          v-progress-circular(indeterminate=true, color=\"primary\")\n        v-col(cols=\"7\").text-start\n          .pt-2 {{ $t('Voice Loading') }}\n\n    .pa-4(v-if=\"!adv.m_ScriptTextName\")\n      KeyValue(:k=\"$t('No Scenario')\")\n    .py-4.text-center(v-else-if=\"loading\")\n      v-progress-circular(indeterminate=true, color=\"primary\")\n    template(v-else)\n      div(v-for=\"item in text\", :key=\"`scenario-text-${item.m_id}`\")\n        Item(:item=\"get_voice_injected_item(item)\" :show_voice=\"() => voice_loaded\")\n\n      v-divider\n      Ad(:key=\"`scenario-ad-${id}`\")\n\n      template(v-if=\"adv.m_LibraryID!=-1\")\n        v-divider.mb-4\n        .px-4\n          .float-right\n            v-btn(icon, :disabled=\"!scenarios[index+1]\",\n              @click=\"$router.replace(`/scenario/${scenarios[index+1].m_AdvID}`)\")\n              v-icon mdi-chevron-right\n          div\n            v-btn(icon, :disabled=\"!scenarios[index-1]\",\n              @click=\"$router.replace(`/scenario/${scenarios[index-1].m_AdvID}`)\")\n              v-icon mdi-chevron-left\n</template>\n\n<script>\nimport axios from 'axios';\nimport Item from './Item';\nimport cri from \"../../components/cri/acb\";\nimport define from \"../../define\";\nconst fs = window.require(\"fs\");\nconst Buffer = window.require(\"buffer\").Buffer;\n\nexport default {\n  name: 'Scenario',\n  props: ['id'],\n  components: { Item },\n  data() {\n    return {\n      loading: 0,\n      text: null,\n      cue_list: {},\n      voice_promise: undefined,\n    };\n  },\n  computed: {\n    adv() {\n      return this.$store.state.$db.ADVList[this.id];\n    },\n    cue () {\n      return this.$s.loadScenarioVoice ? this.adv.m_CueSheet : undefined;\n    },\n    categories() {\n      return {\n        1: { name: 'story', path: 'Story' },\n        2: { name: 'event', path: 'Event' },\n        3: { name: 'chara', path: 'CharaEvent' },\n        4: { name: 'chara', path: 'CrossEvent' },\n        5: { name: 'weapon', path: 'WeaponEvent' },\n        6: { name: 'other', path: 'Other' },\n        7: { name: 'writer', path: 'Writer' },\n      };\n    },\n    scenarios() {\n      let scenarios = this.adv.m_LibraryID == -1 ? [] :\n        this.$store.state.$db.ADVListArray.filter(item => item.m_LibraryID == this.adv.m_LibraryID);\n      for (let i = 0; i < scenarios.length; i++) {\n        if (i > 0 && scenarios[i].m_ScriptTextName &&\n          scenarios[i].m_ScriptTextName == scenarios[i - 1].m_ScriptTextName) {\n          scenarios[i - 1].m_Title = scenarios[i - 1].m_Title\n            .replace('（イントロ）', '')\n            .replace('イントロ', '')\n            .trim();\n          scenarios.splice(i, 1);\n          i -= 1;\n        }\n      }\n      return scenarios;\n    },\n    index() {\n      for (let i in this.scenarios) {\n        if (this.scenarios[i].m_AdvID == this.id) {\n          return parseInt(i);\n        }\n      }\n      return undefined;\n    },\n    voice_loaded() {\n      return Boolean(Object.keys(this.cue_list).length);\n    },\n  },\n  methods: {\n    get_voice_injected_item (item) {\n      item.voice_url = (async()=> {  \n        await this.voice_promise;\n        return this.cue_list[`${item.m_voiceLabel}_0.wav`];  \n      })();\n      return item;\n    },\n    async get_audiobuffer_then_write(file_name, file_save_name) {\n      const proxy_url =\n        \"https://krr-proxy.herokuapp.com/cri/?name=\";\n      // const rvh = await this.$lazy.rvh;\n\n      await fetch(`${proxy_url}${file_name}`)\n        .then((res) => res.arrayBuffer())\n        .then((data) => {\n          fs.writeFileSync(file_save_name, Buffer(data));\n        });\n    },\n    get_event_seq(file_base_name) {\n      return ( '00' + String(parseInt(file_base_name.slice(-2))-1)).slice(-2)\n    },\n    async get_acb_awb(file_base_name, file_save_name) {\n      const cri_audio_acb = this.get_audiobuffer_then_write(\n        `${file_base_name}.acb`, `${file_base_name}.acb`\n      );\n      const cri_audio_awb = this.get_audiobuffer_then_write(\n        `${file_base_name}.awb`, `${file_save_name}.awb`\n      );\n      await Promise.all([cri_audio_acb, cri_audio_awb]);\n    },\n    async unpack_to_cue_list(file_base_name, file_save_name) {\n      const key = define.cri_key;\n      const namels_n_prom = await cri.acbParse(`${file_base_name}.acb`, key);\n      namels_n_prom.map(([Name, prom]) => {\n        const url = async () => {\n          await this.voice_promise;\n          await prom().catch(() => {});\n          const audio = fs.readFileSync(\n            `./${file_save_name}/${Name}`\n          );\n          const blob = new Blob([audio], { type: \"audio/wav\" });\n          return URL.createObjectURL(blob);\n        };\n        this.$set(this.cue_list, Name,  { url: url, promise: true });\n      });\n    },\n    async load() {\n      this.cue_list = {};\n      this.voice_promise = undefined;\n      if (!this.adv || !this.adv.m_ScriptTextName) {\n        return;\n      }\n      this.loading += 1;\n      const loading = this.loading;\n      if (this.cue) {\n        let file_save_name = this.cue;\n        if (this.cue.startsWith('event')) {\n          file_save_name = `event_000000000${this.get_event_seq(file_save_name)}`;\n        }\n        this.voice_promise = (async()=>{\n          await this.get_acb_awb(this.cue, file_save_name);\n          await this.unpack_to_cue_list(this.cue, file_save_name);\n        })();\n      }\n      axios\n        .get(this.$asset.advscript.format(\n          this.categories[this.adv.m_Category].name,\n          this.categories[this.adv.m_Category].path,\n          this.adv.m_ScriptTextName) + '.json')\n        .then(response => {\n          if (loading != this.loading) {\n            return;\n          }\n          this.text = response.data;\n          this.loading = 0;\n        });\n    },\n  },\n  watch: {\n    id() {\n      this.load();\n    }\n  },\n  mounted() {\n    this.load();\n  },\n};\n</script>\n\n<style scoped>\n.line {\n  font-size: 80%;\n  line-height: 1.5;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=92fabe94&scoped=true&lang=pug&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=92fabe94&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"92fabe94\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VDivider,VIcon,VProgressCircular,VRow})\n","export * from \"-!../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=92fabe94&scoped=true&lang=css&\""],"sourceRoot":""}