(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c1569"],{"462c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("p",{staticClass:"display px-4 primary--text"},[t._v(t._s(t.$t("Standpic")))]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{cols:"12",sm:"12",lg:"6"}},[a("v-select",{staticClass:"px-4",attrs:{label:t.$t("Character")+" ("+t.characters.length+")",dense:"",items:t.characters.map((function(t,e){return{text:t.m_ADVCharaID,value:e}}))},model:{value:t.characterID,callback:function(e){t.characterID=e},expression:"characterID"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",lg:"3"}},[a("v-select",{staticClass:"px-4",attrs:{label:t.$t("Pose")+" ("+t.poses.length+")",dense:"",items:t.poses.map((function(t,e){return{text:e,value:e}}))},model:{value:t.poseID,callback:function(e){t.poseID=e},expression:"poseID"}})],1),a("v-col",{staticStyle:{position:"relative"},attrs:{cols:"12",sm:"6",lg:"3"}},[a("v-select",{staticClass:"px-4",attrs:{label:t.$t("Face")+" ("+t.faces.length+")",dense:"",items:t.faces.map((function(t,e){return{text:""+t.key[2],value:e}}))},model:{value:t.faceID,callback:function(e){t.faceID=e},expression:"faceID"}}),a("v-overlay",{attrs:{absolute:"",value:t.loading,opacity:"0"}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1)],1)],1),a("v-list-item",{attrs:{target:"_blank",href:t.$const.sites.standpic.format(t.base)}},[a("v-list-item-title",{staticClass:"primary--text"},[t._v(t._s(t.base)+" - "+t._s(t.$t("Assets.Title")))]),a("v-list-item-action",{staticClass:"ma-0"},[a("v-icon",[t._v("mdi-open-in-new")])],1)],1),a("v-divider",{staticClass:"mb-4"}),a("div",{staticClass:"px-4 float-right"},[a("v-btn",{staticClass:"ml-2",attrs:{icon:""},on:{click:function(e){t.scale*=.8}}},[a("v-icon",[t._v("mdi-magnify-minus")])],1),a("v-btn",{staticClass:"ml-2",attrs:{icon:""},on:{click:function(e){t.scale=1}}},[a("v-icon",[t._v("mdi-magnify-close")])],1),a("v-btn",{staticClass:"ml-2",attrs:{icon:""},on:{click:function(e){t.scale/=.8}}},[a("v-icon",[t._v("mdi-magnify-plus")])],1),t.downloading?a("v-progress-circular",{staticClass:"ml-4 mr-2",attrs:{indeterminate:"",size:"20",width:"3"}}):a("v-btn",{staticClass:"ml-2",attrs:{icon:""},on:{click:t.genarateImg}},[a("v-icon",[t._v("mdi-download")])],1)],1),a("div",{staticStyle:{width:"100%",overflow:"hidden",position:"relative"},style:{height:1200*t.scale+"px"}},[a("div",{staticStyle:{position:"absolute",left:"50%",transform:"translateX(-50%)"}},[a("div",{key:t.id,style:{transform:"scale("+t.scale+") translateY("+50*(t.scale-1)/t.scale+"%)"}},[0==t.pose.m_FaceReferenceImageType?a("div",{staticClass:"d-inline-block"},[a("div",{staticStyle:{position:"relative"}},[a("div",{style:t.style},[a("v-img",{staticStyle:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1"},attrs:{src:t.src.face}})],1)]),a("v-img",{attrs:{src:t.src.standpic}})],1):1==t.pose.m_FaceReferenceImageType?a("div",{staticClass:"d-inline-block"},[a("v-img",{attrs:{src:t.src.face}})],1):t._e()])])])],1)},n=[],i=(a("99af"),a("4de4"),a("d81d"),a("fb6a"),a("ace4"),a("b0c0"),a("d3b7"),a("3ca3"),a("1276"),a("2ca0"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a9"),a("72f7"),a("159b"),a("ddb0"),a("2b3d"),a("96cf"),a("bc3a")),c=a.n(i),r={name:"Standpic",props:["id"],data:function(){return{index:[],loading:0,poseID:0,faceID:0,scale:1,characterID:0,downloading:!1}},computed:{characters:function(){var t=this;return this.$db.ADVCharacterListArray.filter((function(e){return e.m_ResourceBaseName.toLowerCase().startsWith(t.id.toLowerCase())}))},character:function(){return this.characters[this.characterID]},poses:function(){return this.character.m_Datas},faces:function(){var t=this;return this.index.filter((function(e){return"face"==e.key[0]&&e.key[1]==t.poseID}))},pose:function(){return this.poses[this.poseID]},face:function(){return this.faces[this.faceID]},base:function(){return this.character.m_ResourceBaseName.toLowerCase()},faceContainerSize:function(){return 270},src:function(){return{standpic:this.$asset.standpic.format(this.base,"".concat(this.base,"_standpic_").concat(this.poseID))+".png",face:this.$asset.standpic.format(this.base,"".concat(this.base,"_face_").concat(this.poseID,"_").concat(this.face&&this.face.key[2]))+".png"}},style:function(){return{width:this.faceContainerSize+"px",height:this.faceContainerSize+"px",position:"absolute",left:this.pose.m_FaceX-this.faceContainerSize/2+"px",top:this.pose.m_FaceY-this.faceContainerSize/2+"px"}}},methods:{load:function(){var t=this;this.loading+=1;var e=this.loading;c.a.get(this.$asset.standpic.format(this.base,"index.json")).then((function(a){e==t.loading&&(t.index=a.data.map((function(e){var a=e.name.split(t.base)[1].split("_").slice(1);return e.key=a,e})),t.poseID>=t.poses.length&&(t.poseID=0),t.faceID>=t.faces.length&&(t.faceID=0),t.loading=0)}))},genarateImg:function(){var t,e,a,s,n,i,c;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return this.downloading=!0,t=document.createElement("canvas"),e=new Image,a=new Image,n=[this.imgOnload(e,this.src.standpic)],this.face&&this.face.key[2]?(n.push(this.imgOnload(a,this.src.face)),s=!0):s=!1,r.next=8,regeneratorRuntime.awrap(Promise.all(n));case 8:return t.width=e.width,t.height=e.height,i=t.getContext("2d"),i.drawImage(e,0,0),s&&i.drawImage(a,this.pose.m_FaceX-a.width/2,this.pose.m_FaceY-a.height/2),r.next=15,regeneratorRuntime.awrap(this.toBlob(t));case 15:c=r.sent,this.fileDownloadFromBlob(c,"".concat(this.base,"_face_").concat(this.poseID,"_").concat(this.face&&this.face.key[2])+".png"),this.downloading=!1;case 18:case"end":return r.stop()}}),null,this)},toBlob:function(t){return new Promise((function(e,a){try{t.toBlob(e)}catch(s){a(s)}}))},imgOnload:function(t,e){var a=this;return new Promise((function(s,n){var i,r,o;return regeneratorRuntime.async((function(l){while(1)switch(l.prev=l.next){case 0:return t.onload=function(){return s()},t.onerror=function(t){return n(t)},l.next=4,regeneratorRuntime.awrap(c.a.get(e,{responseType:"blob"}));case 4:return i=l.sent.data,l.next=7,regeneratorRuntime.awrap(i.arrayBuffer());case 7:r=l.sent,o=a.arrayBufferToBase64(r),t.src="data:image/png;base64,"+o;case 10:case"end":return l.stop()}}))}))},arrayBufferToBase64:function(t){var e="",a=new Uint8Array(t);return a.forEach((function(t){return e+=String.fromCharCode(t)})),btoa(e)},fileDownloadFromBlob:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"img.png",a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=e,s.click(),URL.revokeObjectURL(a)}},watch:{id:function(){this.characterID=0},base:function(){this.load()}},mounted:function(){this.load()}},o=r,l=a("2877"),d=a("6544"),f=a.n(d),u=a("8336"),h=a("62ad"),m=a("ce7e"),p=a("132d"),v=a("adda"),g=a("da13"),b=a("1800"),w=a("5d23"),y=a("a797"),I=a("490a"),_=a("0fd9"),x=a("b974"),C=Object(l["a"])(o,s,n,!1,null,null,null);e["default"]=C.exports;f()(C,{VBtn:u["a"],VCol:h["a"],VDivider:m["a"],VIcon:p["a"],VImg:v["a"],VListItem:g["a"],VListItemAction:b["a"],VListItemTitle:w["d"],VOverlay:y["a"],VProgressCircular:I["a"],VRow:_["a"],VSelect:x["a"]})}}]);
//# sourceMappingURL=chunk-2d0c1569.5060c442.js.map